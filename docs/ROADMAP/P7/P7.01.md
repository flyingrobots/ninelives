---
id: P7.01
title: Workspace Setup & Core Crate Split
estimate: 12h
status: blocked
blocked_by:
- P10.01
blocks:
- P1.09
- P2.09
- P7.02
value: H
---
# [P7.01] Workspace Setup & Core Crate Split

## Summary

Convert the monolithic `ninelives` crate into a Cargo workspace. Split the core resilience primitives (Layers, Services, Algebra, Clock, Jitter, Error, Adaptive, Backoff, etc.) into a new `ninelives-core` crate. The top-level `ninelives` crate will become a re-exporting meta-crate.

## Context

The current `ninelives` crate is growing large. Splitting it improves modularity, reduces compilation times for users who only need specific parts, and provides clearer boundaries for future development and maintenance. The meta-crate ensures backward compatibility.

## Design
- **Workspace**: A top-level `Cargo.toml` will define the workspace.
- **`ninelives-core`**: Contains all fundamental resilience logic that doesn't depend on `tokio` (where possible) or specific transport protocols. This is the minimum viable set of resilience logic.
- **`ninelives` (Meta-Crate)**: A new `ninelives` crate that simply re-exports everything from `ninelives-core`, and eventually `ninelives-control`, `ninelives-observer`, etc., maintaining current import paths.

## Definition of Done
- [ ] Project converted to a Cargo workspace.
- [ ] `ninelives-core` crate created, containing core resilience logic.
- [ ] Original `ninelives` crate becomes a meta-crate re-exporting `ninelives-core`.
- [ ] All existing tests and examples compile and pass against the new structure.
- [ ] `ninelives-cookbook` examples are updated to reflect the new crate structure (if needed for direct core imports).

## Test Plan

### Unit Tests
- [ ] All existing unit tests (from `ninelives` crate) are moved to `ninelives-core` and pass.

### Integration Tests
- [ ] Existing integration tests (e.g., `tests/adaptive_bulkhead.rs`) compile against the `ninelives` meta-crate and pass.
- [ ] `ninelives-cookbook` examples compile and run correctly.

### Build/CI
- [ ] CI pipeline for the workspace passes.
- [ ] `cargo check`, `cargo test`, `cargo build` work correctly from the workspace root.

## Dependencies
- **Requires**: P1.09 (Telemetry Sinks for events). This is a broad refactor that touches almost everything.
- **Enables**: P7.02 (Splitting other crates), P7.03 (Compatibility).
---
id: P2.12
title: ResetCircuitBreaker handler
estimate: 1h
status: closed
blocked_by:
- P2.05
- P2.09
- P2.121
blocks:
- P2.19
value: M
---
# [P2.12] ResetCircuitBreaker handler

## Summary

Implement a `ResetCircuitBreaker` command that allows operators to manually reset a specific circuit breaker by ID. This is critical for recovering from "stuck open" states or forcing a retry after manual intervention.

## Context

The `CircuitBreakerRegistry` (implemented in P2.121) maintains a global map of named circuit breakers. This handler exposes that functionality to the control plane.

## Implementation Details

- **Command**: `BuiltInCommand::ResetCircuitBreaker { id: String }`
- **Action**: Calls `ninelives::circuit_breaker_registry::global().reset(&id)`
- **Response**: `Ack` on success, `Error` if ID not found.

## Definition of Done
- [x] `ResetCircuitBreaker` variant added to `BuiltInCommand`
- [x] Handler logic invokes global registry reset
- [x] Integration test verifies breaker state transitions from Open to Closed

## Test Plan

### Unit/Integration Tests
- [x] **Reset Unknown ID**: Returns error.
- [x] **Reset Open Breaker**:
    1. Trip breaker (force failures).
    2. Verify state is Open.
    3. Send `ResetCircuitBreaker`.
    4. Verify state is Closed/HalfOpen.

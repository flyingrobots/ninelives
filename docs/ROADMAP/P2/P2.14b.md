---
id: P2.14b
title: TransportRouter Wrapper
estimate: 2h
status: closed
blocked_by:
- P2.14a
- P8.01a
blocks:
- P2.15
- P2.19
value: H
---
# [P2.14b] TransportRouter Wrapper

## Summary

Implement the `TransportRouter` struct that wraps a `CommandRouter` and a `Transport`. It bridges the gap between protocol-specific requests and the internal command system.

## Steps
1.  Create `TransportRouter<C, T>`.
2.  Implement `handle(req)`:
    - Call `transport.decode(req)`.
    - Convert to `CommandEnvelope`.
    - Call `router.execute()`.
    - Call `transport.encode(res)`.
3.  Implement error mapping logic using `transport.map_error()`.

## Definition of Done
- [ ] `TransportRouter` implemented.
- [ ] Logic flows from Transport Req -> Router -> Transport Res.

## Test Plan
- [ ] Mock transport test: verify `TransportRouter` correctly marshals data in and out of the inner `CommandRouter`.
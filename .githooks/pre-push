#!/usr/bin/env bash
set -euo pipefail

echo "[pre-push] running cargo fmt -- --check"
cargo fmt -- --check

echo "[pre-push] running cargo clippy --all-targets --all-features -- -D warnings -D missing_docs"
cargo clippy --all-targets --all-features -- -D warnings -D missing_docs

echo "[pre-push] running cargo test --all-features --all-targets"
cargo test --all-features --all-targets

echo "[pre-push] running cargo doc --no-deps with -D warnings"
RUSTDOCFLAGS="-D warnings" cargo doc --no-deps

echo "[pre-push] all checks passed"
